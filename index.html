<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>kilna | 16:9 Ultimate Brand Bible & Enterprise Design System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Cormorant+Garamond:ital,wght@0,300;0,400;0,500;0,600;1,300;1,400;1,500&family=Space+Mono&family=Manrope:wght@200;300;400;500;600;700;800&family=Comfortaa:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Manrope', 'sans-serif'], 
                        serif: ['Cormorant Garamond', 'serif'],
                        mono: ['Space Mono', 'monospace'],
                        brand: ['Comfortaa', 'cursive'], 
                    },
                    colors: {
                        brand: {
                            black: '#0D0D0D',
                            gray: '#888888',
                            light: '#F4F4F4',
                            clay: '#C18C74',
                            paper: '#F9F7F2', 
                            gold: '#B8860B',
                            charcoal: '#1A1A1A',
                            earth: '#4A3728'
                        }
                    }
                }
            }
        }
    </script>
    <style>
        :root { --page-width: 320mm; --page-height: 180mm; }
        body { background-color: #080808; color: #121212; -webkit-print-color-adjust: exact !important; scroll-behavior: smooth; }
        #book-container { width: var(--page-width); margin: 60px auto; background: white; box-shadow: 0 100px 200px rgba(0,0,0,1); }
        .page {
            width: var(--page-width); height: var(--page-height); background: white;
            position: relative; overflow: hidden; page-break-after: always; break-after: page;
        }
        .grid-layout { display: grid; grid-template-columns: repeat(12, 1fr); grid-column-gap: 8mm; padding: 25mm; height: 100%; position: relative; z-index: 10; }
        .page-num { position: absolute; bottom: 12mm; right: 25mm; font-family: 'Space Mono', monospace; font-size: 8pt; color: #121212; opacity: 0.3; }
        .chapter-mark { position: absolute; top: 12mm; left: 12mm; font-family: 'Space Mono', monospace; font-size: 7pt; text-transform: uppercase; letter-spacing: 5px; opacity: 0.2; }
        .ai-container { position: relative; background-color: #f7f7f7; overflow: hidden; border: 1px solid rgba(0,0,0,0.02); }
        .ai-image { width: 100%; height: 100%; object-fit: cover; opacity: 0; transition: opacity 2.5s cubic-bezier(0.4, 0, 0.2, 1); }
        .ai-image.loaded { opacity: 1; }
        .ai-placeholder { position: absolute; inset: 0; display: flex; flex-direction: column; align-items: center; justify-content: center; color: #ccc; font-family: 'Space Mono', monospace; font-size: 8px; text-align: center; padding: 30px; }
        
        /* Graphic Design States */
        .color-card { height: 100%; display: flex; flex-direction: column; justify-content: flex-end; padding: 15px; border-radius: 4px; }
        .do-frame { border: 2px solid #10b981; }
        .dont-frame { border: 2px solid #ef4444; opacity: 0.6; }
        .badge { position: absolute; top: 10px; left: 10px; color: white; padding: 3px 10px; font-size: 9px; font-weight: bold; border-radius: 2px; }

        @media screen { .page { margin-bottom: 60px; } }
        @media print {
            body { background: none; margin: 0; padding: 0; }
            #book-container { margin: 0; box-shadow: none; width: var(--page-width); height: var(--page-height); }
            .no-print { display: none !important; }
            .page { border: none; width: var(--page-width); height: var(--page-height); }
            @page { size: landscape; margin: 0; }
        }
    </style>
</head>
<body>

    <!-- ENTERPRISE CONTROL DASHBOARD -->
    <div class="fixed top-8 right-8 z-50 no-print flex flex-col gap-6 items-end">
        <div class="bg-brand-black/95 text-white p-8 rounded-[40px] shadow-2xl w-[440px] backdrop-blur-3xl border border-white/10">
            <div class="flex justify-between items-start mb-8 border-b border-white/5 pb-6">
                <div>
                    <h3 class="font-bold text-xs tracking-[0.5em] uppercase text-brand-clay mb-1">kilna Brand Intelligence</h3>
                    <p class="text-[9px] text-gray-500 font-mono">SUPREME ENTERPRISE v4.0</p>
                </div>
                <div class="flex flex-col items-end">
                    <span id="progress-val" class="text-[10px] font-mono text-brand-clay">STANDBY</span>
                    <div class="w-24 bg-white/5 h-1 mt-2 rounded-full overflow-hidden">
                        <div id="progress-bar" class="bg-brand-clay h-full w-0 transition-all duration-1000"></div>
                    </div>
                </div>
            </div>

            <!-- Logo Engine -->
            <div class="mb-8">
                <label class="block text-[8px] font-bold uppercase tracking-[0.4em] text-gray-400 mb-4">AI LOGO REFERANS MOTORU</label>
                <div id="drop-zone" class="border-2 border-dashed border-brand-clay/20 rounded-[24px] p-6 flex flex-col items-center justify-center cursor-pointer hover:border-brand-clay transition-all group">
                    <input type="file" id="logo-input" class="hidden" accept="image/*">
                    <div id="logo-preview" class="hidden w-24 h-24 mb-2 rounded-xl overflow-hidden bg-white/5 p-4 border border-white/10 shadow-inner">
                        <img src="" id="logo-img-preview" class="w-full h-full object-contain">
                    </div>
                    <div id="upload-prompt" class="text-center">
                        <svg class="w-10 h-10 mb-2 mx-auto text-brand-clay/30 group-hover:text-brand-clay transition-colors" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24"><path d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"/></svg>
                        <p class="text-[11px] text-gray-400 uppercase tracking-widest">Marka Logosunu Sürükleyin</p>
                    </div>
                </div>
            </div>
            
            <button id="btn-generate" onclick="startGeneration()" class="w-full bg-brand-clay hover:bg-white hover:text-brand-black transition-all duration-700 font-bold text-xs py-6 rounded-[24px] flex items-center justify-center gap-4 shadow-2xl shadow-brand-clay/20">
                <span id="gen-text">ÜRETİM FABRİKASINI BAŞLAT (AI)</span>
                <div id="gen-spinner" class="hidden w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"></div>
            </button>
            
            <div class="grid grid-cols-2 gap-4 mt-6">
                <button onclick="window.scrollTo({top: 0, behavior:'smooth'})" class="bg-white/5 hover:bg-white/10 py-4 rounded-2xl text-[10px] font-bold uppercase tracking-widest transition-all">Navigasyon</button>
                <button id="btn-pdf" onclick="exportPDF()" class="bg-white text-black hover:bg-brand-clay hover:text-white py-4 rounded-2xl text-[10px] font-bold uppercase tracking-widest transition-all flex items-center justify-center gap-2">
                    <svg width="14" height="14" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"/></svg>
                    PDF DIŞA AKTAR
                </button>
            </div>
        </div>
    </div>

    <div id="book-container">
        <!-- Sunum sayfaları JS ile eklenecek -->
    </div>

    <script>
        const apiKey = ""; 
        const book = document.getElementById('book-container');
        let pageCounter = 1;
        let logoBase64 = null;

        // Logo Upload System
        const logoInput = document.getElementById('logo-input');
        const dropZone = document.getElementById('drop-zone');
        const logoPreview = document.getElementById('logo-preview');
        const logoImgPreview = document.getElementById('logo-img-preview');
        const uploadPrompt = document.getElementById('upload-prompt');

        dropZone.onclick = () => logoInput.click();
        logoInput.onchange = (e) => {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    logoBase64 = e.target.result.split(',')[1];
                    logoImgPreview.src = e.target.result;
                    logoPreview.classList.remove('hidden');
                    uploadPrompt.classList.add('hidden');
                };
                reader.readAsDataURL(file);
            }
        };

        const emblemSvg = (color = "currentColor", size = "200") => `
            <svg width="${size}" height="${size}" viewBox="0 0 100 100" fill="none">
                <circle cx="50" cy="50" r="46" stroke="${color}" stroke-width="0.15" stroke-dasharray="2 4" />
                <circle cx="50" cy="50" r="39" stroke="${color}" stroke-width="0.3" />
                <circle cx="50" cy="50" r="28" stroke="${color}" stroke-width="0.8" opacity="0.6" />
                <circle cx="50" cy="50" r="18" stroke="${color}" stroke-width="1.5" opacity="0.4" />
                <circle cx="50" cy="50" r="5" fill="${color}" />
            </svg>
        `;

        const renderPage = (chapter, content, options = {}) => {
            const page = document.createElement('div');
            page.className = `page ${options.bg || ''} ${options.className || ''}`;
            page.innerHTML = `
                ${options.hideMark ? '' : `<div class="chapter-mark ${options.dark ? 'text-white/20' : 'text-black/20'}">${chapter}</div>`}
                <div class="grid-layout">
                    ${content}
                </div>
                ${options.hideNum ? '' : `<div class="page-num ${options.dark ? 'text-white/20' : 'text-black/20'}">${pageCounter.toString().padStart(2, '0')}</div>`}
            `;
            book.appendChild(page);
            pageCounter++;
        };

        const aiImg = (prompt, ratio = "aspect-video") => `
            <div class="ai-container ${ratio} w-full rounded-sm overflow-hidden group">
                <div class="ai-placeholder">
                    <span class="mb-3 opacity-30 uppercase tracking-[0.5em] text-[7px]">Luxury Visual Production Pipeline</span>
                    <span class="opacity-10 text-[6px] italic px-32 leading-relaxed font-mono">${prompt}</span>
                </div>
                <img data-prompt="${prompt}" class="ai-image" />
            </div>
        `;

        // --- SUNUM İNŞASI (HARMANLANMIŞ VE GELİŞTİRİLMİŞ) ---

        const initBible = () => {
            // P01: ULTIMATE COVER
            renderPage('KAPAK', `
                <div class="col-span-12 h-full flex flex-col items-center justify-center text-center relative -m-[25mm] bg-brand-paper">
                    <div class="absolute inset-0 opacity-[0.05] flex items-center justify-center">${emblemSvg("#121212", "120%")}</div>
                    <div class="z-10 px-40">
                        <div class="mb-16 border border-brand-clay/30 rounded-full px-16 py-4 font-mono text-[10px] uppercase tracking-[0.6em] text-brand-clay inline-block">Enterprise Identity v.4.0</div>
                        <h1 class="font-brand font-bold text-[280px] leading-[0.7] lowercase text-brand-black tracking-tighter mb-12">kilna</h1>
                        <p class="font-serif italic text-[64px] text-brand-black/60 tracking-tight leading-none mb-40">The art of imperfect beauty.</p>
                        <div class="grid grid-cols-3 w-full max-w-5xl text-[10px] font-mono uppercase tracking-[0.5em] opacity-30 border-t border-black/5 pt-12">
                            <div>Stratejik Marka İncili</div><div>16:9 Presentation Format</div><div>UI Design System</div>
                        </div>
                    </div>
                </div>
            `, { hideMark: true, hideNum: true });

            // P02: STRATEJİ
            renderPage('01. STRATEJİ', `
                <div class="col-span-12 grid grid-cols-12 gap-16 h-full items-center">
                    <div class="col-span-7 flex flex-col justify-center">
                        <span class="font-mono text-xs text-brand-clay tracking-[0.5em] mb-12 uppercase">Marka Felsefesi</span>
                        <h2 class="font-serif italic text-[110px] leading-[0.8] mb-12 tracking-tighter text-brand-black">Toprağın <br>Belleği.</h2>
                        <p class="font-sans text-xl leading-relaxed text-gray-500 max-w-xl italic border-l border-brand-clay pl-8 py-2">"Kilna, çamurun sabrını modern insanın evine taşıyan bir aracıdır. Tornanın merkezindeki o sonsuz döngü, hayatın mükemmel olmayan biricikliğinin kanıtıdır."</p>
                    </div>
                    <div class="col-span-5 h-[140mm] shadow-2xl">
                        ${aiImg("Extreme high-end macro shot of a single ceramic plate edge showing organic glaze cracks, museum lighting, stone background", "h-full")}
                    </div>
                </div>
            `);

            // P03: AMBLEM Engineering
            renderPage('02. LOGO SİSTEMİ', `
                <div class="col-span-12 grid grid-cols-12 gap-16 h-full items-center">
                    <div class="col-span-5 bg-gray-50 aspect-square flex items-center justify-center p-24 rounded-[40px] relative overflow-hidden border border-dashed border-gray-200">
                        <div class="absolute inset-0 opacity-[0.05] grid grid-cols-12 grid-rows-12">
                            ${Array(144).fill('<div class="border border-blue-400"></div>').join('')}
                        </div>
                        <div class="z-10 scale-[2.2]">${emblemSvg("#121212", "200")}</div>
                        <div class="absolute bottom-6 left-10 font-mono text-[8px] text-brand-clay">GRID ARCHITECTURE: RADIAL SYMMETRY</div>
                    </div>
                    <div class="col-span-7 flex flex-col justify-center space-y-12">
                        <h3 class="font-sans font-bold text-6xl uppercase tracking-tighter text-brand-clay">Merkezkaç Amblem Rasyoneli</h3>
                        <p class="text-sm text-gray-600 leading-relaxed max-w-xl">Amblem, seramik tornasının dönme hareketinden ve Fibonacci oranlarından türetilmiştir. Halkalar, yaratımın merkezindeki zanaatkarın odağını simgeler. <strong>Sebep:</strong> Sürekli değişim ve gelişimi toprağın sükunetiyle dengelemek.</p>
                        <div class="grid grid-cols-2 gap-8 border-t border-black/5 pt-12">
                            <div><span class="font-mono text-[9px] uppercase font-bold text-gray-400">Amblem Oranı</span><p class="text-[11px] mt-2 italic">Logo genişliğinin %35'i kadar alan kaplamalıdır.</p></div>
                            <div><span class="font-mono text-[9px] uppercase font-bold text-gray-400">Optik Balans</span><p class="text-[11px] mt-2 italic">Dairelerin kalınlığı merkezden dışa doğru %15 oranında incelir.</p></div>
                        </div>
                    </div>
                </div>
            `);

            // P04: LOGO DO & DON'T Visual Library
            renderPage('02. LOGO SİSTEMİ', `
                <div class="col-span-12 flex flex-col justify-center">
                    <h3 class="font-sans font-bold text-5xl mb-12 uppercase tracking-tighter">Logo Yönetişimi: Do & Don't</h3>
                    <div class="grid grid-cols-4 gap-8">
                        <div class="do-frame aspect-square bg-gray-50 flex items-center justify-center rounded-[32px] relative">
                            <span class="badge bg-emerald-500 uppercase">Correct</span>
                            <span class="font-brand font-bold text-4xl lowercase">kilna</span>
                        </div>
                        <div class="dont-frame aspect-square bg-gray-50 flex items-center justify-center rounded-[32px] relative">
                            <span class="badge bg-red-500 uppercase">Logo Tilt</span>
                            <span class="font-brand font-bold text-4xl rotate-12 opacity-30">kilna</span>
                        </div>
                        <div class="dont-frame aspect-square bg-brand-clay flex items-center justify-center rounded-[32px] relative">
                            <span class="badge bg-red-500 uppercase">Contrast</span>
                            <span class="font-brand font-bold text-4xl text-brand-black/20">kilna</span>
                        </div>
                        <div class="dont-frame aspect-square bg-gray-50 flex items-center justify-center rounded-[32px] relative">
                            <span class="badge bg-red-500 uppercase">Shadow</span>
                            <span class="font-brand font-bold text-4xl shadow-xl opacity-30">kilna</span>
                        </div>
                    </div>
                    <p class="mt-8 text-[11px] text-gray-400 font-mono uppercase tracking-widest text-center">Marka logosu asla manipüle edilemez, oranları korunmalıdır.</p>
                </div>
            `);

            // P05: RENK PALETİ - LUXURY SPEC
            renderPage('03. RENK MİMARİSİ', `
                <div class="col-span-12 h-full flex flex-col justify-center">
                    <h3 class="font-serif italic text-7xl mb-16">Luxury Color Architecture</h3>
                    <div class="grid grid-cols-12 gap-4 h-96">
                        <div class="col-span-5 bg-brand-clay color-card text-white rounded-[32px] shadow-2xl relative">
                            <div class="absolute top-8 left-8 border border-white/20 p-2 font-mono text-[8px]">CORE COLOR</div>
                            <h4 class="font-serif italic text-5xl mb-6">Terracotta Clay</h4>
                            <div class="grid grid-cols-2 font-mono text-[10px] uppercase tracking-widest gap-x-12 opacity-70">
                                <div>HEX: #C18C74<br>RGB: 193/140/116</div>
                                <div>CMYK: 22/47/53/3<br>PANTONE: 7522C</div>
                            </div>
                        </div>
                        <div class="col-span-7 grid grid-cols-3 gap-4">
                            <div class="bg-brand-black color-card text-white rounded-[32px]">
                                <h4 class="font-sans font-bold text-[10px] uppercase mb-4 opacity-50 tracking-widest">Charcoal Dark</h4>
                                <p class="font-mono text-[9px]">HEX: #0D0D0D<br>Pantone: Black 6C</p>
                            </div>
                            <div class="bg-brand-paper border border-black/5 color-card rounded-[32px]">
                                <h4 class="font-sans font-bold text-[10px] uppercase mb-4 opacity-50 tracking-widest">Raw Paper Silk</h4>
                                <p class="font-mono text-[9px]">HEX: #F9F7F2<br>Pantone: 7527C</p>
                            </div>
                            <div class="bg-brand-earth color-card text-white rounded-[32px]">
                                <h4 class="font-sans font-bold text-[10px] uppercase mb-4 opacity-50 tracking-widest">Deep Soil</h4>
                                <p class="font-mono text-[9px]">HEX: #4A3728<br>Pantone: 476C</p>
                            </div>
                        </div>
                    </div>
                </div>
            `);

            // P06: TİPOGRAFİ & BLOG (Sentezlendi)
            renderPage('04. TİPOGRAFİ', `
                <div class="col-span-12 grid grid-cols-12 gap-16 items-center h-full">
                    <div class="col-span-6 space-y-16">
                        <h3 class="font-serif italic text-7xl leading-tight text-brand-black">Blog Hiyerarşisi ve <br>Editoryal Kurallar.</h3>
                        <div class="space-y-10">
                            <div class="flex justify-between items-end border-b pb-4"><span class="font-serif italic text-6xl">H1 / Editorial Headline</span><span class="font-mono text-[9px]">Cormorant 84pt</span></div>
                            <div class="flex justify-between items-end border-b pb-4"><span class="font-sans font-extrabold text-2xl uppercase tracking-[0.2em]">H2 / Enterprise Subhead</span><span class="font-mono text-[9px]">Manrope 32pt</span></div>
                            <div class="flex justify-between items-end border-b pb-4"><span class="font-sans text-lg">Body Copy Regular</span><span class="font-mono text-[9px]">Manrope 18pt / 1.6LH</span></div>
                        </div>
                    </div>
                    <div class="col-span-6 bg-white border border-black/5 shadow-2xl p-20 rounded-[40px] relative overflow-hidden">
                        <div class="absolute top-0 right-0 p-12 opacity-[0.05] scale-150">${emblemSvg()}</div>
                        <div class="mb-10"><span class="font-mono text-[10px] text-brand-clay uppercase tracking-[0.5em] font-bold">Atölye Kayıtları • 2026</span><h4 class="font-serif italic text-5xl mt-6 text-brand-black leading-tight">Ateşle Terbiye Edilen <br>Ham Toprak.</h4></div>
                        <div class="mb-10 h-40">${aiImg("Potter hands shaping a tall white vase, dramatic motion blur, studio lighting", "aspect-video")}</div>
                        <p class="text-base font-sans leading-relaxed text-gray-500 italic opacity-80">"Modern dünyanın hızına bir başkaldırıdır kilna. Biz fabrikasyon pürüzsüzlüğü değil, elin bıraktığı o eşsiz izi kutsuyoruz."</p>
                    </div>
                </div>
            `);

            // P07: AMBALAJ MİMARİSİ (Lüks Segment)
            renderPage('05. AMBALAJ', `
                <div class="col-span-12 grid grid-cols-12 gap-16 items-center h-full">
                    <div class="col-span-7 h-[130mm] shadow-2xl rounded-sm overflow-hidden relative group">
                        ${aiImg("Luxury sustainable ceramic packaging mockup, debossed black logo on heavy textured white paper, wax seal with Kilna emblem", "h-full")}
                    </div>
                    <div class="col-span-5 flex flex-col justify-center space-y-12">
                        <h3 class="font-serif italic text-8xl leading-none text-brand-black">Unboxing <br>Ritüeli.</h3>
                        <p class="text-xl opacity-60 leading-relaxed italic">"Paket açılış anı, markayla kurulan en mahrem fiziksel temas anıdır. Sesi, kokusu ve dokusuyla bir bütün olarak kurgulanmıştır."</p>
                        <div class="space-y-6 pt-12 border-t border-black/5">
                            <div class="flex items-center gap-6"><div class="w-12 h-12 bg-gray-50 rounded-full flex items-center justify-center font-mono text-[9px]">01</div><p class="text-sm font-sans">GF Smith Extract kağıt üzerine Siyah Gofre.</p></div>
                            <div class="flex items-center gap-6"><div class="w-12 h-12 bg-gray-50 rounded-full flex items-center justify-center font-mono text-[9px]">02</div><p class="text-sm font-sans">Kil mühürlü ham keten ip sabitleme.</p></div>
                        </div>
                    </div>
                </div>
            `);

            // P08: ENTERPRISE UI SYSTEM
            renderPage('06. UI SYSTEM', `
                <div class="col-span-12 flex flex-col justify-center">
                    <h3 class="font-serif italic text-7xl mb-16">Enterprise Design System</h3>
                    <div class="grid grid-cols-12 gap-12">
                        <div class="col-span-4 p-12 border border-gray-100 rounded-[40px] space-y-16 bg-gray-50/30">
                             <div class="space-y-6">
                                <span class="font-mono text-[10px] text-brand-clay uppercase tracking-widest font-bold">Action Components</span>
                                <div class="bg-brand-black text-white py-5 text-center text-[10px] font-bold uppercase tracking-[0.4em] rounded-2xl shadow-xl">Ritüele Ekle</div>
                                <div class="border border-brand-black text-black py-5 text-center text-[10px] font-bold uppercase tracking-[0.4em] rounded-2xl">Koleksiyonu Gör</div>
                             </div>
                             <div class="space-y-4">
                                <span class="font-mono text-[10px] text-brand-clay uppercase tracking-widest font-bold">Design Tokens</span>
                                <div class="flex gap-4"><div class="w-12 h-12 bg-brand-clay rounded-xl"></div><div class="w-12 h-12 bg-brand-black rounded-xl"></div><div class="w-12 h-12 bg-brand-earth rounded-xl"></div></div>
                             </div>
                        </div>
                        <div class="col-span-8 shadow-2xl rounded-[40px] overflow-hidden">
                             ${aiImg("Clean luxury ceramics e-commerce interface on a ultra-wide monitor, elegant white-space, high-end photography", "aspect-video")}
                        </div>
                    </div>
                </div>
            `);

            // TEKNİK SPEC SAYFALARI (100+ SAYFA SİMÜLASYONU)
            for(let i=1; i<=88; i++) {
                if(i % 30 === 0) {
                     renderPage('APPENDIX', `
                        <div class="col-span-12 h-full flex flex-col justify-center items-center text-center -m-[25mm] p-40 bg-brand-black text-white relative">
                            <div class="absolute inset-0 opacity-[0.03] scale-150 pointer-events-none">${emblemSvg("#FFFFFF", "100%")}</div>
                            <span class="font-mono text-xs text-brand-clay mb-10 uppercase tracking-[0.8em]">PRODUCTION VOLUME / VOL. ${Math.floor(i/30)}</span>
                            <h2 class="font-serif italic text-[140px] mb-12 tracking-tighter text-brand-paper leading-none">Uygulama <br>Standartları.</h2>
                            <div class="w-32 h-px bg-brand-clay mb-20"></div>
                            <div class="grid grid-cols-4 gap-8 w-full opacity-10 px-40">
                                ${Array(12).fill('<div class="h-1 bg-gray-500 rounded-full"></div>').join('')}
                            </div>
                        </div>
                    `, { hideMark: true, hideNum: true });
                } else {
                    renderPage('ŞARTNAME', `
                        <div class="col-span-12 h-full">
                            <div class="flex justify-between items-end border-b-2 border-black pb-6 mb-12">
                                <h3 class="font-sans font-bold text-[12px] uppercase tracking-[0.5em] text-brand-clay">Spec No: K-UX-${6000 + i}</h3>
                                <span class="font-mono text-[9px] opacity-40 uppercase tracking-widest font-bold">Enterprise Asset Standard v4.0</span>
                            </div>
                            <div class="grid grid-cols-12 gap-16 h-[110mm]">
                                <div class="col-span-7 flex flex-col justify-between">
                                    <h4 class="font-serif italic text-6xl leading-tight text-brand-black uppercase tracking-tighter">Uygulama Alanı: ${['E-Posta İmzası', 'Araç Giydirme', 'Mağaza Tabelası', 'Personel Kimliği', 'Social Motion Graphic'][i % 5]}</h4>
                                    <div class="bg-gray-100 rounded-[40px] p-12 h-64 flex items-center justify-center relative overflow-hidden group border border-black/5">
                                         <div class="absolute inset-0 opacity-[0.05] scale-150">${emblemSvg()}</div>
                                         <div class="font-mono text-[8px] opacity-20 uppercase tracking-[0.4em] text-center px-12 leading-relaxed italic font-bold">TEKNİK TASLAK MİMARİSİ VE <br>GRID TABANLI KOMPOZİSYON STANDARTLARI</div>
                                    </div>
                                    <p class="text-[11px] text-gray-400 leading-relaxed font-sans uppercase tracking-[0.3em] italic opacity-60">Kurumsal kimlik disiplini gereği tüm vektörel çalışmalar ana merkezkaç halkası üzerinden hizalanmalıdır.</p>
                                </div>
                                <div class="col-span-5 flex flex-col gap-8">
                                    <div class="shadow-2xl rounded-2xl overflow-hidden flex-1">${aiImg("Macro detail of " + ['branding element', 'packaging surface', 'exhibition lighting', 'digital interface detail', 'printed luxury paper'][i % 5], "h-full")}</div>
                                    <div class="bg-brand-paper p-12 rounded-[40px] border border-black/5 flex-1 flex flex-col justify-center">
                                         <span class="font-mono text-[9px] font-bold uppercase block mb-4 text-brand-clay tracking-[0.5em]">YÖNETİŞİM:</span>
                                         <p class="text-[12px] italic text-gray-500 leading-relaxed italic border-l-2 border-brand-clay/30 pl-6">"Tornanın Merkezkaç yasası, markanın tüm üretimlerinde merkezden dışa doğru genişleyen bir görsel hiyerarşi oluşturur."</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    `, { hideMark: (i > 10) });
                }
            }

            // P100: THE END
            renderPage('SON', `
                <div class="col-span-12 h-full flex flex-col items-center justify-center text-center -m-[25mm] bg-brand-black text-white relative">
                    <div class="absolute top-[25mm] opacity-5 scale-150">${emblemSvg("#FFFFFF", "400")}</div>
                    <h2 class="font-brand font-bold text-[240px] lowercase mb-16 tracking-tighter">kilna</h2>
                    <div class="w-40 h-px bg-brand-clay mb-20"></div>
                    <p class="font-mono text-sm tracking-[2em] text-gray-500 uppercase">Her şey merkezden başlar.</p>
                    <div class="mt-40 text-[10px] font-mono text-gray-700 uppercase tracking-widest opacity-40">© 2026 KILNA GLOBAL BRANDING GOVERNANCE. TÜM HAKLARI SAKLIDIR.</div>
                </div>
            `, { hideMark: true, hideNum: true, dark: true });
        };

        // --- PRODUCTION ENGINES ---

        async function exportPDF() {
            const element = document.getElementById('book-container');
            const btn = document.getElementById('btn-pdf');
            if (!btn || !element) return;
            btn.innerText = "YAZDIRILIYOR...";
            btn.disabled = true;
            const opt = {
                margin: 0,
                filename: 'kilna-supreme-brand-bible.pdf',
                image: { type: 'jpeg', quality: 1.0 },
                html2canvas: { scale: 1.2, useCORS: true, logging: false },
                jsPDF: { unit: 'mm', format: [320, 180], orientation: 'landscape' },
                pagebreak: { mode: ['avoid-all', 'css', 'legacy'] }
            };
            try {
                await html2pdf().set(opt).from(element).save();
                btn.innerText = "TAMAMLANDI";
            } catch (err) { btn.innerText = "HATA"; } finally {
                setTimeout(() => { btn.innerText = "PDF İNDİR"; btn.disabled = false; }, 3000);
            }
        }

        async function fetchWithRetry(prompt, maxRetries = 5) {
            const isLogoRef = !!logoBase64;
            const model = isLogoRef ? 'gemini-2.5-flash-image-preview' : 'imagen-4.0-generate-001';
            document.getElementById('progress-indicator').style.opacity = "1";

            const enhancedPrompt = isLogoRef 
                ? `Resmi marka logosunu referans al. Şu objenin ultra-lüks editoryal ürün çekimini yap: ${prompt}. Logoyu objenin yüzeyine (derin gofre, altın varak veya hassas serigrafi olarak) kusursuzca entegre et. Sahne: Minimalist müze aydınlatması, wabi-sabi estetiği, yüksek doku detayı.`
                : prompt;

            for (let i = 0; i < maxRetries; i++) {
                try {
                    let response;
                    if (isLogoRef) {
                        const payload = {
                            contents: [{ parts: [{ text: enhancedPrompt }, { inlineData: { mimeType: "image/png", data: logoBase64 } }] }],
                            generationConfig: { responseModalities: ['TEXT', 'IMAGE'] }
                        };
                        response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${model}:generateContent?key=${apiKey}`, {
                            method: "POST", headers: { "Content-Type": "application/json" }, body: JSON.stringify(payload),
                        });
                    } else {
                        response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${model}:predict?key=${apiKey}`, {
                            method: "POST", headers: { "Content-Type": "application/json" },
                            body: JSON.stringify({ instances: [{ prompt: enhancedPrompt }], parameters: { sampleCount: 1 } }),
                        });
                    }
                    if (response.ok) return await response.json();
                    if (response.status === 429) await new Promise(r => setTimeout(r, Math.pow(2, i) * 1000));
                } catch (e) {
                    if (i === maxRetries - 1) return null;
                    await new Promise(r => setTimeout(r, Math.pow(2, i) * 1000));
                }
            }
            return null;
        }

        async function startGeneration() {
            const btn = document.getElementById('btn-generate');
            const spinner = document.getElementById('gen-spinner');
            const text = document.getElementById('gen-text');
            const progressBar = document.getElementById('progress-bar');
            const progressVal = document.getElementById('progress-val');
            const images = document.querySelectorAll('img[data-prompt]');
            
            btn.disabled = true; spinner.classList.remove('hidden');
            text.innerText = logoBase64 ? "LOGO ANALİZ EDİLİYOR..." : "ÜRETİLİYOR...";

            let completed = 0;
            for (const img of images) {
                const prompt = img.getAttribute('data-prompt');
                try {
                    const data = await fetchWithRetry(prompt);
                    let base64 = null;
                    if (logoBase64) {
                        base64 = data.candidates?.[0]?.content?.parts?.find(p => p.inlineData)?.inlineData?.data;
                    } else {
                        base64 = data?.predictions?.[0]?.bytesBase64Encoded;
                    }
                    if (base64) {
                        img.src = `data:image/png;base64,${base64}`;
                        img.onload = () => {
                            img.classList.add('loaded');
                            if (img.previousElementSibling) img.previousElementSibling.style.display = 'none';
                        };
                    }
                } catch (e) { console.warn(e); }
                completed++;
                const perc = Math.floor((completed / images.length) * 100);
                progressBar.style.width = `${perc}%`;
                progressVal.innerText = `%${perc}`;
            }

            spinner.classList.add('hidden');
            text.innerText = "ÜRETİM TAMAMLANDI";
            btn.disabled = false;
        }

        window.onload = initBible;
    </script>
</body>
</html>
